var bignum=require("bignumber.js");bignum.config({ROUNDING_MODE:1});var src=require("../src/src");class ChineseRemainderTransform{rootOfUnityForwardTable(r,e){for(var s=new Array(src.cycleorder/2),i=new Array(src.cycleorder/2),n=bignum("1"),o=0;o<src.cycleorder/2;o++)s[o]=n,i[o]=n.times(bignum("2").pow(64)).idiv(e),n=n.times(r).mod(e);return[s,i]}rootOfUnityInverseTable(r,e){for(var s=new Array(src.cycleorder/2),i=new Array(src.cycleorder/2),n=bignum("1"),o=0;o<src.cycleorder/2;o++)s[o]=n,i[o]=n.times(bignum("2").pow(64)).div(e),n=n.times(r).mod(e);return[s,i]}ModMulPrecon(r,e,s,i){for(var n=new Array(r.length),o=0;o<r.length;o++){var c=r[o].times(i[o]).minus(r[o].times(i[o]).mod(bignum("18446744073709551616"))).div(bignum("18446744073709551616")),a=r[o].times(e[o]).minus(c.times(s));n[o]=a.minus(s).gte(bignum("0"))?a.minus(s):a}return n}NTTForward(r,e,s,i){for(var n=new Array(src.cycleorder/2),o=0;o<src.cycleorder/2;o++)n[o]=r[this.ReverseBits(o,9)];for(var c=Math.log2(src.cycleorder/2),a=1;a<=c;a++){var m=[];for(o=0;o<1<<a-1;o++)m.push(o<<1+c-a);for(var t=0;t<src.cycleorder/2;t+=1<<a)for(o=0;o<1<<a-1;o++){var u=m[o],l=e[u],d=s[u],v=t+o,f=v+(1<<a-1),g=n[f];if(g.eq(bignum("0")))n[f]=n[v];else{if(g.eq(bignum("1")))var y=l;else y=this.ModMulPrecon([g],[l],i,[d])[0];var b=n[v];(b=b.plus(y)).gte(i)&&(b=b.minus(i));var w=n[v];w.lt(y)&&(w=w.plus(i)),w=w.minus(y),n[v]=b,n[f]=w}}}return n}ReverseBits(r,e){return(src.table[255&r]<<8|src.table[r>>8&255])>>src.shift[7&e]}FindRotationIndex(r,e){var s=e/2,i=e-1;if(r<s/2)for(var n=5,o=1;o<r;o++)n=5*n%e;else for(n=i,o=s/2;o<r;o++)n=5*n%e;return n}}module.exports=new ChineseRemainderTransform;